### HW9. Ansible roles, delegate_to
``` 
Плейбук который запускает две роли:

1. Устанавливает docker, docker-compose, делает рестарт сервера, плейбук не должен падать и после рестарта выводит версию docker, которая установлена в системе, не версию из переменных и т.д.
2. Устанавливает Jenkins в контейнере
```
### Use the ping module to ping the nodes in our inventory
``` 
$ ansible jenkins -u ansible -m ping
192.168.0.109 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
```
### Check syntax playbook
``` 
ansible-playbook --syntax-check jenkins.yml

playbook: jenkins.yml
```
### Run playbook jenkins
``` 
$ ansible-playbook jenkins.yml

PLAY [Install jenkins] *************************************************************************************************
TASK [Gathering Facts] *************************************************************************************************ok: [192.168.0.109]

TASK [docker : Update repositories cache and install docker dependencies] **********************************************
changed: [192.168.0.109] => (item=apt-transport-https)
ok: [192.168.0.109] => (item=ca-certificates)
ok: [192.168.0.109] => (item=software-properties-common)
ok: [192.168.0.109] => (item=curl)
ok: [192.168.0.109] => (item=gnupg)
ok: [192.168.0.109] => (item=lsb-release)

TASK [docker : Add docker repo apt key] ********************************************************************************
changed: [192.168.0.109]

TASK [docker : Add Docker Repository] **********************************************************************************
changed: [192.168.0.109]

TASK [docker : Update apt and install docker] **************************************************************************
changed: [192.168.0.109] => (item=docker-ce)
ok: [192.168.0.109] => (item=docker-ce-cli)
ok: [192.168.0.109] => (item=containerd.io)

TASK [docker : Start and enable systemd service docker] ****************************************************************
ok: [192.168.0.109]

TASK [docker : Add user to docker group] *******************************************************************************
changed: [192.168.0.109] => (item=ubuntu)
changed: [192.168.0.109] => (item=ansible)

TASK [docker : Install docker-compose] *********************************************************************************
changed: [192.168.0.109]

TASK [docker : Create a symbolic link] *********************************************************************************
changed: [192.168.0.109]
TASK [docker : Check the uptime] ************************************************************************************************************************************************************************************************************
changed: [192.168.0.109]

TASK [docker : Check the uptime] ************************************************************************************************************************************************************************************************************
changed: [192.168.0.109]

TASK [docker : debug] ***********************************************************************************************************************************************************************************************************************
ok: [192.168.0.109] => {
    "msg": " 16:41:18 up  1:23,  1 user,  load average: 0.38, 0.09, 0.03"
}

TASK [docker : Reboot] **********************************************************************************************************************************************************************************************************************
changed: [192.168.0.109]

TASK [docker : Check the uptime after reboot] ***********************************************************************************************************************************************************************************************
changed: [192.168.0.109]

TASK [docker : debug] ***********************************************************************************************************************************************************************************************************************
ok: [192.168.0.109] => {
    "msg": " 16:42:52 up 1 min,  1 user,  load average: 3.33, 1.09, 0.38"
}

TASK [docker : Check version docker] ********************************************************************************************************************************************************************************************************
changed: [192.168.0.109]

TASK [docker : debug] ***********************************************************************************************************************************************************************************************************************
ok: [192.168.0.109] => {
    "msg": "Docker version 20.10.8, build 3967b7d"
}

TASK [jenkins : Create a directories] *******************************************************************************************************************************************************************************************************
changed: [192.168.0.109] => (item=jenkins)
changed: [192.168.0.109] => (item=nginx)

TASK [jenkins : Create docker-compose.yml file] *********************************************************************************************************************************************************************************************
changed: [192.168.0.109]

TASK [jenkins : Deploy Docker Compose] ******************************************************************************************************************************************************************************************************
ok: [192.168.0.109]

TASK [jenkins : Deploy WP Nginx virtual host] ***********************************************************************************************************************************************************************************************
changed: [192.168.0.109]

TASK [jenkins : Run docker-compose] *********************************************************************************************************************************************************************************************************
changed: [192.168.0.109]

PLAY RECAP **********************************************************************************************************************************************************************************************************************************
192.168.0.109              : ok=12   changed=18    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```
![screen shot web page](https://github.com/v-kostyukov/ithillel-tasks/blob/master/HW9/img/screen1.png)
![screen shot web page](https://github.com/v-kostyukov/ithillel-tasks/blob/master/HW9/img/screen2.png)
### Docker ps
![screen shot web page](https://github.com/v-kostyukov/ithillel-tasks/blob/master/HW9/img/screen3.png)